---
import type { SanityDocument } from "@sanity/client";
import Heading from "../components/typography/Heading.astro";
import Layout from "../layouts/Layout.astro";
import { loadQuery } from "../sanity/lib/load-query";
import type Post from "../types/Post";
import { POSTS_QUERY } from "../sanity/lib/queries";
import BlogCard from "../components/cards/BlogCard.astro";

const posts = await loadQuery<Post[]>({
  query: POSTS_QUERY,
});

console.log(posts.data.map((post) => post.categories));
---

<Layout title="Blog">
  <main>
    <section class="lg:min-h-[89vh] w-full">
      <div class="container flex flex-col justify-center h-full py-16">
        <Heading text="Read Something" size="lg" />
        <ul class="grid grid-cols-1 lg:grid-cols-2 py-4">
          {
            posts.data.map((post) => (
              <BlogCard
                title={post.title}
                mainImage={post.mainImage}
                description={post.description}
                publishedAt={post.publishedAt}
                categories={post.categories}
                href={`/blog/${post.slug.current}`}
              />
            ))
          }
        </ul>
      </div>
    </section>
  </main>
</Layout>
